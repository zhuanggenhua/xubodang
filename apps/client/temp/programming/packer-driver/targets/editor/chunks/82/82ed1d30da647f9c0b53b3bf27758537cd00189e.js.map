{"version":3,"sources":["file:///C:/Users/Admin/Desktop/zgh-temp/test/gtest/ctest/xubodang/apps/client/assets/scripts/scene/HomeMgr.ts"],"names":["_decorator","Component","Node","Prefab","SpriteFrame","DataManager","ParticleMgr","LightParticle","FaderManager","PrefabPathEnum","TexturePathEnum","ResourceManager","ccclass","property","HomeMgr","particleMgr","onLoad","loadRes","Instance","fadeOut","canvas","addComponent","init","gap","node","on","EventType","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","list","type","p","then","prefab","prefabMap","set","push","loadDir","spriteFrames","textureMap","Promise","all","onDestroy","clear","off","event","touch","gather","getLocation","offGather","start","update","deltaTime"],"mappings":"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","sourcesContent":["import {\r\n  _decorator,\r\n  Color,\r\n  Component,\r\n  EventTouch,\r\n  GradientRange,\r\n  Graphics,\r\n  instantiate,\r\n  Node,\r\n  ParticleSystem2D,\r\n  Prefab,\r\n  SpriteFrame,\r\n  sys,\r\n  tween,\r\n} from 'cc'\r\nimport DataManager, { mapH, mapW } from '../global/DataManager'\r\nimport { getRandomNumber } from '../utils'\r\nimport ParticleMgr from '../particle/ParticleMgr'\r\nimport { LightParticle } from '../particle/LightParticle'\r\nimport FaderManager from '../global/FaderManager'\r\nimport NetworkManager from '../global/NetworkManager'\r\nimport {  PrefabPathEnum, TexturePathEnum } from '../enum'\r\nimport { ResourceManager } from '../global/ResourceManager'\r\nconst { ccclass, property } = _decorator\r\n\r\n@ccclass('HomeMgr')\r\nexport class HomeMgr extends Component {\r\n  @property(Node)\r\n  canvas: Node = null\r\n  @property(Node)\r\n  bg: Node = null\r\n\r\n  particleMgr: ParticleMgr\r\n\r\n  onLoad() {\r\n    this.loadRes()\r\n    FaderManager.Instance.fadeOut(1000)\r\n\r\n    this.particleMgr = this.canvas.addComponent(ParticleMgr)\r\n    this.particleMgr.init(LightParticle, {\r\n      gap: 0.5,\r\n      // max: 1,\r\n    })\r\n\r\n    // this.node.on(Node.EventType.TOUCH_START, this.onTouchStart, this)\r\n    this.node.on(Node.EventType.TOUCH_MOVE, this.onTouchMove, this)\r\n    this.node.on(Node.EventType.TOUCH_END, this.onTouchEnd, this)\r\n  }\r\n  // 加载资源\r\n  async loadRes() {\r\n    const list = []\r\n    for (const type in PrefabPathEnum) {\r\n      const p = ResourceManager.Instance.loadRes(PrefabPathEnum[type], Prefab).then((prefab) => {\r\n        DataManager.Instance.prefabMap.set(type, prefab)\r\n      })\r\n      list.push(p)\r\n    }\r\n    for (const type in TexturePathEnum) {\r\n      const p = ResourceManager.Instance.loadDir(TexturePathEnum[type], SpriteFrame).then((spriteFrames) => {\r\n        DataManager.Instance.textureMap.set(type, spriteFrames)\r\n      })\r\n      list.push(p)\r\n    }\r\n    await Promise.all(list)\r\n  }\r\n\r\n  onDestroy() {\r\n    this.particleMgr.clear()\r\n    // this.node.off(Node.EventType.TOUCH_START, this.onTouchStart, this)\r\n    this.node.off(Node.EventType.TOUCH_MOVE, this.onTouchMove, this)\r\n    this.node.off(Node.EventType.TOUCH_END, this.onTouchEnd, this)\r\n  }\r\n\r\n  onTouchMove(event: EventTouch) {\r\n    // 辉光聚拢效果\r\n    const touch = event.touch\r\n    this.particleMgr.gather(touch.getLocation())\r\n  }\r\n  onTouchEnd() {\r\n    this.particleMgr.offGather()\r\n  }\r\n\r\n  start() {}\r\n\r\n  update(deltaTime: number) {\r\n    this.particleMgr.update(deltaTime)\r\n  }\r\n}\r\n"]}